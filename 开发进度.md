# OMO Switch 开发进度

## 2024-02-15 供应商配置前端重构

### 已完成

1. **ProviderList.tsx 更新**
   - 新增 `ProviderInfo` 接口（替代旧的 `ProviderPreset`）
   - 支持分组显示：已配置供应商 / 内置供应商
   - 已配置供应商显示删除按钮
   - 未配置供应商显示配置按钮
   - 保留旧接口导出以保持兼容性

2. **ProviderPage.tsx 更新**
   - 调用新的 `get_provider_status` API 获取供应商列表
   - 支持分组显示逻辑
   - 集成新的模态框组件
   - 添加删除供应商授权功能

3. **ApiKeyModal.tsx 创建**
   - 简单的 API Key 输入框
   - 调用 `set_provider_api_key` 保存配置
   - 调用 `test_provider_connection` 测试连接
   - 显示测试结果反馈

4. **CustomProviderModal.tsx 创建**
   - 供应商名称输入
   - API Key 输入
   - Base URL 输入
   - 调用 `add_custom_provider` 保存配置
   - 支持连接测试

5. **翻译文件更新**
   - 更新 `zh-CN.json` 添加新的翻译键
   - 更新 `en.json` 添加新的翻译键
   - 新增翻译键：
     - configured / builtin / builtinTag / customTag
     - addCustom / addCustomDesc / addCustomSuccess / addCustomFailed
     - customName / customNamePlaceholder / customNameRequired
     - apiKeyRequired / baseUrlRequired
     - noConfigured / noBuiltin
     - deleteConfirm / deleteSuccess / deleteFailed
     - delete / configure
     - setApiKey / setApiKeyDesc / testConnection

### API 对接说明

后端需要提供以下 API：

- `get_provider_status()` -> `ProviderInfo[]`
- `set_provider_api_key(provider_id: string, api_key: string)`
- `delete_provider_auth(provider_id: string)`
- `add_custom_provider(name: string, api_key: string, base_url: string)`
- `test_provider_connection(npm: string | null, base_url: string | null, api_key: string)`

### 兼容性说明

- 保留 `ProviderStatus` 组件（Tab 1 使用）
- 保留 `ProviderForm` 组件（导出旧接口以保持兼容）
